rm(list=ls())
library(rio)
oil=import("Module 4 Data Sets.xlsx",sheet="Oil and Gas")
setwd("G:/Masters/BAIS/QMB/Module 4")
oil=import("Module 4 Data Sets.xlsx",sheet="Oil and Gas")
colnames(oil)=tolower(make.names(colnames(oil)))
View(oil)
oil=import("Module 4 Data Sets.xlsx",sheet="Oil and Gas")
View(oil)
colnames(oil)=tolower(make.names(colnames(oil)))
attach(oil)
plot(crude,gasoline,pch=19,main="Oil & Gas Raw Data Plot")
oilout=lm(gasoline~crude,data=oil)
?lm()
cor(crude, gasoline)
?cor()
?lm()
summary(oilout)
View(oilout)
oilout
confint(oilout)
?confint()
plot(crude,gasoline,pch=19,main="Oil & Gas Raw Data Plot")
abline(oilout,lwd=3,col="red")
plot(resid(oilout),pch=19,main="O&G Residual Plot by Order of Data")
abline(0,0,col="red",lwd=3)
plot(oilout$fitted.values,oilout$residuals,pch=19,main="O&G Plot by Fitted Values")
plot(rstandard(oilout),pch=19,main="Oil & Gas Standardized Residuals")
abline(0,0,col="red",lwd=3)
plot(oilout$fitted.values,oilout$residuals,pch=19,main="O&G Plot by Fitted Values")
plot(rstandard(oilout),pch=19,main="Oil & Gas Standardized Residuals")
abline(0,0,col="red",lwd=3)
#Linearity
plot(oil$gasoline,oilout$fitted.values,pch=19,main="O&G Actual v. Fitted Values")
abline(0,1,col="red",lwd=3)
#Normality
qqnorm(oilout$residuals,pch=19,main="O&G Normality Plot")
qqline(oilout$residuals,col="red",lwd=3)
hist(oilout$residuals)
plot(density(oilout$residuals))
library(moments)
skewness(oilout$residuals)
kurtosis(oilout$residuals)
#Equality of Variances
plot(oilout$fitted.values,oilout$residuals,pch=19,
main="O&G Residuals")
abline(0,0,col="red",lwd=3)
#Equality of Variances
plot(oilout$fitted.values,oilout$residuals,pch=19,
main="O&G Residuals", ylim=(-50, 50))
#Equality of Variances
plot(oilout$fitted.values,oilout$residuals,pch=19,
main="O&G Residuals", ylim=c(-50, 50))
abline(0,0,col="red",lwd=3)
?rstandard()
#OR
plot(oilout$fitted.values,rstandard(oilout),pch=19,
main="O&G Standardized Residuals")
rstandard(oilout)
rm(list=ls())
tools=import("Module 4 Data Sets.xlsx",sheet="Cutting Tools")
colnames(tools)=tolower(make.names(colnames(tools)))
attach(tools)
View(tools)
brand.a.out=lm(brand.a~speed,data=tools)
brand.b.out=lm(brand.b~speed,data=tools)
summary(brand.a.out)
summary(brand.b.out)
plot(speed,brand.a,ylim=c(0,7),xlim=c(30,80),pch=19,
main="Cutting Tools Plot")
points(speed,brand.b,col="red",pch=19)
abline(brand.a.out,lwd=3)
abline(brand.b.out,lwd=3,col="red")
cor(speed,brand.a);cor(speed,brand.b)
plot(speed,rstandard(brand.a.out),pch=19,ylim=c(-4,4),
main="Cutting Tools Std. Residual Plot")
points(speed,rstandard(brand.b.out),pch=19,col="red")
abline(0,0,col="blue",lwd=3)
rm(list=ls())
x=rnorm(1000,100,10)
y=rnorm(1000,200,20)
y=rnorm(1000,200,20)
plot(x,y,pch=19,main="Shotgun Blast")
cor(x,y)
cor(x,y)^2
regout=lm(y~x)
summary(regout)
abline(regout,lwd=3,col="red")
qqnorm(resid(regout),pch=19)
qqline(resid(regout),col="red",lwd=3)
plot(y,rstandard(regout),pch=19,main="Standardized Residuals")
abline(0,0,lwd=3,col="red")
?resid()
qqnorm(resid(regout),pch=19)
qqline(resid(regout),col="red",lwd=3)
plot(y,rstandard(regout),pch=19,main="Standardized Residuals")
abline(0,0,lwd=3,col="red")
x=rnorm(1000,100,10)
y=x^5
plot(x,y,pch=19,xlim=c(0,150),
main="Exponential Relationship")
cor(x,y)
regout=lm(y~x)
abline(regout,lwd=3,col="red")
sum(regout$residuals)
qqnorm(resid(regout),pch=19)
qqline(resid(regout),col="red",lwd=3)
plot(regout$fitted.values,rstandard(regout),pch=19,
main="Exponential Model, Standardized Residuals")
abline(0,0,col="red",lwd=3)
oil=import("Module 4 Data Sets.xlsx",sheet="Oil and Gas")
colnames(oil)=tolower(make.names(colnames(oil)))
attach(oil)
plot(crude,gasoline,pch=19,main="Oil & Gas Raw Data Plot")
?lm()
?cor()
cor(crude, gasoline)
oilout=lm(gasoline~crude,data=oil)
oilout
summary(oilout)
?confint()
confint(oilout)
plot(crude,gasoline,pch=19,main="Oil & Gas Raw Data Plot")
abline(oilout,lwd=3,col="red")
plot(resid(oilout),pch=19,main="O&G Residual Plot by Order of Data")
abline(0,0,col="red",lwd=3)
plot(oilout$fitted.values,oilout$residuals,pch=19,main="O&G Plot by Fitted Values")
plot(rstandard(oilout),pch=19,main="Oil & Gas Standardized Residuals")
abline(0,0,col="red",lwd=3)
#Linearity
plot(oil$gasoline,oilout$fitted.values,pch=19,main="O&G Actual v. Fitted Values")
abline(0,1,col="red",lwd=3)
#Normality
qqnorm(oilout$residuals,pch=19,main="O&G Normality Plot")
qqline(oilout$residuals,col="red",lwd=3)
hist(oilout$residuals)
plot(density(oilout$residuals))
skewness(oilout$residuals)
kurtosis(oilout$residuals)
#Equality of Variances
plot(oilout$fitted.values,oilout$residuals,pch=19,
main="O&G Residuals", ylim=c(-50, 50))
abline(0,0,col="red",lwd=3)
#OR
plot(oilout$fitted.values,rstandard(oilout),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
#OR
plot(oilout$fitted.values,rstandard(oilout),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
?predict
setwd("G:/Masters/BAIS/QMB/Dumps")
library(readxl)
automobiles <- read_xlsx("6304 Module 4 Assignment_Tejas.docx")
automobiles <- read_xlsx('6304 Module 4 Assignment_Tejas.docx')
automobiles <- read_xlsx("6304 Module 4 Assignment Data_Tejas.xlsx")
library(dplyr)
View(automobiles)
data_vermont <- subset(automobiles, region="vermont" )
data_vermont <- subset(automobiles, region=="vermont" )
data_vermont <- subset(automobiles, Region=="vermont" )
data_vermont <- subset(automobiles, REGION=="vermont" )
colnames(automobiles) <- tolower(colnames(automobiles))
automobiles <- read_xlsx("6304 Module 4 Assignment Data_Tejas.xlsx")
colnames(automobiles) <- tolower(colnames(automobiles))
data_vermont <- subset(automobiles, region=="vermont" )
data_vermont <- subset(automobiles, region=="vermont", model>2000,
condition=c('excellent','good'))
View(data_vermont)
data_vermont <- subset(automobiles, region=="vermont" & model>2000 &
condition=c('excellent','good'))
data_vermont <- subset(automobiles, region=="vermont" & model>2000 &
condition==c('excellent','good'))
data_vermont <- subset(automobiles, region=="vermont" & model>2000 &
condition in ('excellent','good'))
data_vermont <- subset(automobiles, region=="vermont" & model>2000 &
( condition == ('excellent') | condition == ('good')))
View(data_vermont)
data_vermont <- subset(automobiles, region == "vermont" & year > 2000 &
( condition == ('excellent') | condition == ('good')))
automobiles <- read_xlsx("6304 Module 4 Assignment Data_Tejas.xlsx")
colnames(automobiles) <- tolower(colnames(automobiles))
data_vermont <- subset(automobiles, region == "vermont" & year > 2000 &
( condition == ('excellent') | condition == ('good')))
primary_data <- sample_n(data_vermont, 60)
reg_analy <- lm(price~odometer, data=primary_data)
cor(price, odometer)
View(primary_data)
?cor(price, odometer,)
?cor(primary_data$price, primary_data$odometer,)
cor(primary_data$price, primary_data$odometer,)
plot(primary_data$price, primary_data$odometer)
plot(primary_data$price, primary_data$odometer, pch=19)
abline(reg_analy)
abline(reg_analy, lwd=3,col="red")
summary(reg_analy)
confint(reg_analy)
#question 1
plot(primary_data$price, primary_data$odometer, pch=19,
main='Price vs Odometer')
abline(reg_analy, lwd=3,col="red")
plot(primary_data$price, primary_data$odometer, pch=19,
main='Price vs Odometer raw data')
abline(reg_analy, lwd=3,col="red")
plot(primary_data$price,reg_analy$fitted.values,pch=19,
main="P&O Actual v. Fitted Values")
abline(0,1,col="red",lwd=3)
#Normality
qqnorm(reg_analy$residuals,pch=19,main="O&G Normality Plot")
qqline(reg_analy$residuals,col="red",lwd=3)
hist(reg_analy$residuals)
plot(density(reg_analy$residuals))
skewness(reg_analy$residuals)
kurtosis(reg_analy$residuals)
qqnorm(reg_analy$residuals,pch=19,main="O&G Normality Plot")
qqline(reg_analy$residuals,col="red",lwd=3)
plot(density(reg_analy$residuals))
skewness(reg_analy$residuals)
kurtosis(reg_analy$residuals)
hist(reg_analy$residuals)
plot(density(reg_analy$residuals))
hist(reg_analy$residuals)
plot(density(reg_analy$residuals))
#Equality of Variances
plot(reg_analy$fitted.values,rstandard(reg_analy),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
plot(primary_data$price,reg_analy$fitted.values,pch=19,
main="P&O Actual v. Fitted Values")
abline(0,1,col="red",lwd=3)
plot(reg_analy$fitted.values,rstandard(reg_analy),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
#Equality of Variances
plot(reg_analy$fitted.values)
plot(rstandard(reg_analy))
#Equality of Variances
plot(reg_analy$fitted.values)
plot(rstandard(reg_analy))
plot(reg_analy$fitted.values,rstandard(reg_analy),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
newdata=data.frame(odometer=183362)
predict(reg_analy,newdata,interval="predict")
predict(reg_analy,newdata,interval="confidence")
flights <- read_xlsx("6304 Module 4 Assignment Data_Sujhan.xlsx")
View(flights)
colnames(flights) <- tolower(make.names(colnames(flights)))
?sample_n
reduced_data <- sample_n(flights, 0.15*nrows(flights))
reduced_data <- sample_n(flights, (0.15*nrows(flights)))
0.15*nrows(flights)
?nrows
?base::nrows
nrows((flights))
nrow((flights))
0.15*nrow(flights)
reduced_data <- sample_n(flights, (0.15*nrow(flights)))
#Analysis
#q1
cor(reduced_data$fare, reduced_data$air.miles)
set.seed(54500765)
reduced_data <- sample_n(flights, (0.15*nrow(flights)))
#Analysis
#q1
cor(reduced_data$fare, reduced_data$air.miles)
#q2
fare_out <- lm(fare, air.miles, data=reduced_data)
#q2
fare_out <- lm(fare~air.miles, data=reduced_data)
#q3
newdata=data.frame(air.miles=8439)
#q3
newdata=data.frame(air.miles=8439)
predict(fare_out,newdata,interval="predict")
predict(fare_out,newdata,interval="confidence")
max(flight$air.miles)
max(flights$air.miles)
#q2.a
summary(fare_out)
confint(fare_out)
#q2.c
#Linearity
plot(reduced_data$fare, fare_out$fitted.values,pch=19,
main="Actual vs. Fitted Values of fare")
abline(0,1,col="red",lwd=3)
#normality
qqnorm(fare_out$residuals,pch=19,main="Fares and Air miles Normality Plot")
qqline(fare_out$residuals,col="red",lwd=3)
hist(fare_out$residuals)
plot(density(fare_out$residuals))
skewness(fare_out$residuals)
kurtosis(fare_out$residuals)
#normality
qqnorm(fare_out$residuals,pch=19,main="Fares and Air miles Normality Plot")
qqline(fare_out$residuals,col="red",lwd=3)
hist(fare_out$residuals)
plot(density(fare_out$residuals))
skewness(fare_out$residuals)
kurtosis(fare_out$residuals)
plot(fare_out$fitted.values,rstandard(fare_out),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
#Equality of Variances
plot(fare_out$fitted.values)
plot(rstandard(fare_out))
plot(fare_out$fitted.values,rstandard(fare_out),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
plot(density(fare_out$residuals))
lues,rstandard(fare_out),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lw
#Equality of Variances
plot(fare_out$fitted.values,rstandard(fare_out),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
#Equality of Variances
plot(fare_out$fitted.values,rstandard(fare_out),pch=19,
main="O&G Standardized Residuals")
abline(0,0,col="red",lwd=3)
#q2.d
newdata=data.frame(air.miles=900)
predict(fare_out,newdata,interval="predict")
predict(fare_out,newdata,interval="confidence")
?predict
newdata=data.frame(air.miles=8439)
predict(fare_out,newdata,interval="predict")
predict(fare_out,newdata,interval="confidence")
max(flights$air.miles)
setwd("G:/Masters/BAIS/QMB/Module 4/Assignment 4")
master_data <- read_xlsx("6304 Module 4 Assignment Data.xlsx")
View(master_data)
master_data <- read_xlsx("6304 Module 4 Assignment Data.xlsx",
sheet = 'Tamil Anatomy')
View(master_data)
colnames(master_data)=tolower(make.names(colnames(master_data)))
attach(master_data)
View(master_data)
master_data <- read_xlsx("6304 Module 4 Assignment Data.xlsx",
sheet = 'Tamil Anatomy')
colnames(master_data)=tolower(make.names(colnames(master_data)))
attach(master_data)
set.seed(54500765)
primary_data <- sample_n(master_data, 70)
cor(primary_data$height, primary_data$left.foot.length)
lm_out <- lm(left.foot.length~height, data = primary_data)
summary(lm_out)
confint(lm_out)
#q2.c
#Linearity
plot(primary_data$left.foot.length , lm_out$fitted.values, pch=19,
main = "Actual vs. Fitted Values of Left Foot Length")
abline(0,1,col="red",lwd=3)
#Normality
qqnorm(lm_out$residuals,pch=19,main="Residuals Normality Plot")
qqline(lm_out$residuals,col="red",lwd=3)
hist(lm_out$residuals)
plot(density(lm_out$residuals))
hist(lm_out$residuals)
plot(density(lm_out$residuals))
skewness(lm_out$residuals)
kurtosis(lm_out$residuals)
#Equality of Variances
plot(lm_out$fitted.values,rstandard(lm_out),pch=19,
main="Standardized Residuals for Height and Left Foot Length")
abline(0,0,col="red",lwd=3)
#q2.d
newdata=data.frame(height=66)   #5.5 feet = 66 Inches
predict(lm_out,newdata,interval="predict")
predict(lm_out,newdata,interval="confidence")
boy=data.frame(height=48)   #4 feet = 48 Inches
predict(lm_out,boy,interval="predict")
predict(lm_out,boy,interval="confidence")
max(primary_data)
max(primary_data$height)
min(primary_data$height)
max(primary_data$left.foot.length)
min(primary_data$left.foot.length)
